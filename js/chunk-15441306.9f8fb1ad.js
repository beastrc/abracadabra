(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15441306"],{"0cb4":function(e,t,a){},"57e9":function(e,t,a){e.exports=a.p+"img/i-icon.4b7942a4.svg"},"7e6b":function(e,t,a){"use strict";a("0cb4")},cba4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"deposit-borrow-block"},["borrow"===e.actionType?i("h3",[e._v("Deposit collateral")]):e._e(),"repay"===e.actionType?i("h3",[e._v("Repay "+e._s(e.tokenPairName))]):e._e(),i("div",{staticClass:"input-wrap"},[i("ValueInput",{attrs:{max:e.maxMainValue,parentValue:e.mainValue,error:e.mainValueError,valueName:e.mainValueTokenName},on:{onchange:e.updateMainValue}})],1),"borrow"===e.actionType?i("h3",[e._v("Borrow "+e._s(e.tokenPairName))]):e._e(),"repay"===e.actionType?i("h3",[e._v("Remove collateral")]):e._e(),i("div",{staticClass:"input-wrap"},[i("ValueInput",{attrs:{max:e.maxPairValue,showMax:e.showMax,valueName:e.pairValueTokenName,parentValue:e.pairValue,error:e.pairValueError},on:{onchange:e.updatePairValue}})],1),"borrow"===e.actionType?i("div",{staticClass:"config-box"},[i("LiquidationRules",{attrs:{liquidationPrice:e.liquidationPrice,maxValue:e.ltv,value:e.percentValue},on:{onchange:e.updatePercentValue}})],1):e._e(),"borrow"===e.actionType?i("div",{staticClass:"config-box"},[i("div",{staticClass:"checkbox-wrap"},[i("div",{staticClass:"box-wrap",class:{active:e.showLeverage},on:{click:e.toggleShowLeverage}},[i("div",{staticClass:"box"})]),i("p",{staticClass:"label-text",on:{click:e.toggleShowLeverage}},[e._v("Change leverage")]),i("img",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Some txt",expression:"'Some txt'"}],staticClass:"info-icon",attrs:{src:a("57e9"),alt:""}})]),e.showLeverage?[i("transition",{attrs:{name:"fade"}},[i("SlipageBlock",{attrs:{slipage:e.slipage},on:{update:e.updateSlipage}})],1),i("transition",{attrs:{name:"fade"}},[i("LeverageBar",{attrs:{multiplier:e.multiplier},on:{update:e.updateMultiplier}})],1)]:e._e()],2):e._e(),i("div",{staticClass:"action-wrap"},[i("div",{staticClass:"checkbox-wrap"},[i("div",{staticClass:"box-wrap",class:{active:e.updatePrice},on:{click:e.toggleUpdatePrice}},[i("div",{staticClass:"box"})]),i("p",{staticClass:"label-text",on:{click:e.toggleUpdatePrice}},[e._v("Update price")]),i("img",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Update ibTKN price for a small gas fee",expression:"'Update ibTKN price for a small gas fee'"}],staticClass:"info-icon",attrs:{src:a("57e9"),alt:""}})]),i("button",{staticClass:"btn action-btn",attrs:{disabled:"Nothing to do"===e.actionBtnText},on:{click:e.actionHandler}},[e._v(" "+e._s(e.actionBtnText)+" ")])])])},r=[],s=a("1da1"),n=a("5530"),l=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("a9e3"),a("25f0"),a("b680"),a("4d63"),a("ac1f"),a("466d"),function(){return a.e("chunk-d3c2f27a").then(a.bind(null,"6618"))}),o=function(){return a.e("chunk-499a2183").then(a.bind(null,"df5d"))},u=function(){return a.e("chunk-8e88cba2").then(a.bind(null,"ac53"))},h=function(){return a.e("chunk-7f2c6163").then(a.bind(null,"1392"))},p={props:{balance:{required:!0},pairBalance:{require:!0},tokenName:{type:String,required:!0},tokenToUsd:{type:Number,default:1},tokenPairToUsd:{type:Number,default:1},tokenPairName:{type:String,required:!0},userTotalCollateral:{required:!0},userTotalBorrowed:{required:!0},actionType:{type:String,required:!0},tokenDecimals:{type:Number,required:!0},tokenPairDecimals:{type:Number,required:!0},ltv:{type:Number,required:!0},isUpdatePrice:{type:Boolean}},data:function(){return{userBalance:null,mainValue:"",mainValueError:"",pairValue:"",pairValueError:"",percentValue:"",updatePrice:this.isUpdatePrice,multiplier:1,slipage:1,showLeverage:!1}},watch:{actionType:function(){this.clearData()}},computed:{liquidationMultiplier:function(){return(200-this.ltv)/100},showMax:function(){return"borrow"!==this.actionType},maxMainValue:function(){return"borrow"===this.actionType?this.userBalance:"repay"===this.actionType?parseFloat(this.userTotalBorrowed)>parseFloat(this.parsedPairBalance)?this.parsedPairBalance:this.userTotalBorrowed:0},mainValueTokenName:function(){return"borrow"===this.actionType?this.tokenName:"repay"===this.actionType?this.tokenPairName:"XX"},pairValueTokenName:function(){return"borrow"===this.actionType?this.tokenPairName:"repay"===this.actionType?this.tokenName:"XX"},pairValueDecimals:function(){return"borrow"===this.actionType?this.tokenPairDecimals:"repay"===this.actionType?this.tokenDecimals:18},mainValueDecimals:function(){return"borrow"===this.actionType?this.tokenDecimals:"repay"===this.actionType?this.tokenPairDecimals:18},parsedPairBalance:function(){return this.$ethers.utils.formatUnits(this.pairBalance.toString(),this.tokenPairDecimals)},maxPairValue:function(){var e,t;if("borrow"===this.actionType)return this.mainValue?(e=this.mainValue/this.tokenToUsd,t=e/100*(this.ltv-1)):(e=this.userTotalCollateral/this.tokenToUsd,t=e/100*(this.ltv-1)-this.userTotalBorrowed),t;if("repay"===this.actionType){var a=parseFloat(+this.userTotalCollateral).toFixed(20),i=new RegExp("^-?\\d+(?:.\\d{0,"+(this.pairValueDecimals||-1)+"})?");return a.toString().match(i)[0]}return 0},signer:function(){return this.$store.getters.getSigner},actionBtnText:function(){if(this.mainValueError||this.pairValueError)return"Nothing to do";if("borrow"===this.actionType){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0)return"Add collateral and borrow";if(this.mainValue)return"Add collateral";if(this.pairValue)return"Borrow"}if("repay"===this.actionType){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0)return"Remove collateral and repay";if(this.mainValue)return"Repay";if(this.pairValue)return"Remove collateral"}return"Nothing to do"},liquidationPrice:function(){if(!this.percentValue)return"xxx.xx";if(!this.mainValue&&this.pairValue){var e=(+this.userTotalBorrowed+ +this.pairValue)*this.tokenToUsd/+this.userTotalCollateral*(1/this.tokenToUsd)*this.liquidationMultiplier;return e.toFixed(2)}if(this.mainValue&&this.pairValue){var t=+this.pairValue*this.tokenToUsd/+this.mainValue*(1/this.tokenToUsd)*this.liquidationMultiplier||0;return t.toFixed(2)}return"xxx.xx"}},methods:{updateMultiplier:function(e){this.multiplier=e},updateSlipage:function(e){this.slipage=e},toggleUpdatePrice:function(){this.updatePrice=!this.updatePrice},toggleShowLeverage:function(){!0===this.showLeverage&&(this.multiplier=1),this.showLeverage=!this.showLeverage},toFixed:function(e,t){var a=new RegExp("^-?\\d+(?:.\\d{0,"+(t||-1)+"})?");return e.toString().match(a)[0]},actionHandler:function(){if(this.mainValue&&this.pairValue&&parseFloat(this.pairValue)>0){if("borrow"===this.actionType){var e=this.$ethers.utils.parseUnits(this.mainValue.toString(),this.mainValueDecimals),t=this.$ethers.utils.parseUnits(this.toFixed(this.pairValue,6),this.pairValueDecimals),a={collateralAmount:e,amount:t,updatePrice:this.updatePrice};if(this.multiplier>1)return a.amount=this.toFixed(this.pairValue,6),this.multiplierHandle(a,"addAndBorrowMultiple"),!1;this.$emit("addAndBorrow",a)}if("repay"===this.actionType){var i=this.$ethers.utils.parseUnits(this.toFixed(this.mainValue,6),this.mainValueDecimals),r=this.$ethers.utils.parseUnits(this.pairValue.toString(),this.pairValueDecimals),s={collateralAmount:i,amount:r,updatePrice:this.updatePrice};if(this.mainValue===this.maxMainValue&&this.pairValue===this.maxPairValue)return i=this.$ethers.utils.parseUnits(this.userTotalBorrowed,this.mainValueDecimals),r=this.$ethers.utils.parseUnits(this.userTotalCollateral,this.pairValueDecimals),s={collateralAmount:i,amount:r,updatePrice:this.updatePrice},this.$emit("removeAndRepayMax",s),!1;this.$emit("removeAndRepay",s)}return!1}if(this.mainValue){if("borrow"===this.actionType){var n=this.$ethers.utils.parseUnits(this.mainValue.toString(),this.mainValueDecimals),l={amount:n,updatePrice:this.updatePrice};this.$emit("addCollateral",l)}if("repay"===this.actionType){var o=this.$ethers.utils.parseUnits(this.toFixed(this.mainValue,6),this.mainValueDecimals),u={amount:o,updatePrice:this.updatePrice};this.$emit("repay",u)}return!1}if(this.pairValue){if("borrow"===this.actionType){var h=this.$ethers.utils.parseUnits(this.toFixed(this.pairValue,6),this.pairValueDecimals),p={amount:h,updatePrice:this.updatePrice};if(this.multiplier>1)return p.amount=this.toFixed(this.pairValue,6),this.multiplierHandle(p,"borrowMultiple"),!1;this.$emit("borrow",p)}if("repay"===this.actionType){var c=this.$ethers.utils.parseUnits(this.pairValue.toString(),this.pairValueDecimals),m={amount:c,updatePrice:this.updatePrice};this.$emit("removeCollateral",m)}return!1}},multiplierHandle:function(e,t){var a=parseFloat(this.percentValue);if(!a)return!1;for(var i=(100-this.slipage)/100,r=a/100,s=.995*e.amount,l=0,o=this.multiplier;o>0;o--)l+=+s,s*=r;var u=this.$ethers.utils.parseUnits(this.toFixed(l,this.pairValueDecimals),this.pairValueDecimals),h=l*this.tokenToUsd*i,p=this.$ethers.utils.parseUnits(this.toFixed(h,this.mainValueDecimals),this.mainValueDecimals),c=Object(n["a"])(Object(n["a"])({},e),{},{amount:u,minExpected:p});this.$emit(t,c)},clearData:function(){this.mainValue="",this.mainValueError="",this.pairValue="",this.pairValueError="",this.percentValue=""},updateMainValue:function(e){if(this.mainValue=e,parseFloat(e)>parseFloat(this.maxMainValue))return this.mainValueError="The value cannot be greater than ".concat(this.maxMainValue),!1;if(this.mainValueError="","repay"===this.actionType){var t=this.pairValue/this.maxPairValue*100,a=e/this.userTotalBorrowed*100,i=this.userTotalBorrowed/this.tokenPairToUsd,r=this.userTotalCollateral/this.tokenToUsd,s=r-i,n=s/r*100;return t<=a&&t<n?(this.pairValueError="",!1):(this.pairValueError="You have insufficient collateral. Please enter a smaller amount or repay more.",!1)}this.pairValue&&this.updatePairValue(this.pairValue),this.percentValue&&e&&(this.pairValue=this.maxPairValue*this.percentValue/this.ltv)},updatePairValue:function(e){if(parseFloat(e)>parseFloat(this.maxPairValue))return this.pairValueError="The value cannot be greater than ".concat(this.maxPairValue),!1;if("repay"===this.actionType){e||(this.pairValueError="",this.pairValue=e);var t=this.userTotalBorrowed/this.tokenPairToUsd,a=this.userTotalCollateral/this.tokenToUsd,i=a-t,r=i/a*100,s=e/this.maxPairValue*100,n=this.mainValue/this.userTotalBorrowed*100;return r<s&&s>n?(this.pairValueError="You have insufficient collateral. Please enter a smaller amount or repay more.",this.pairValue=e,!1):(this.pairValueError="",this.pairValue=e,!1)}if(this.pairValueError="",this.pairValue=e,!e)return this.updatePercentValue(""),!1;this.updatePercentValue(parseFloat(this.pairValue/this.maxPairValue*this.ltv).toFixed(4),!0)},updatePercentValue:function(e,t){if(this.percentValue=e,t)return!1;this.mainValue&&e&&(this.pairValue=this.maxPairValue*e/this.ltv)},getUserBalance:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.$ethers.utils.formatUnits(e.balance.toString(),e.tokenDecimals),e.userBalance=a;case 2:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getUserBalance();case 2:case"end":return t.stop()}}),t)})))()},components:{ValueInput:l,LiquidationRules:o,LeverageBar:u,SlipageBlock:h}},c=p,m=(a("7e6b"),a("2877")),d=Object(m["a"])(c,i,r,!1,null,"5af1b566",null);t["default"]=d.exports}}]);